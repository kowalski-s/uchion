import type { SubjectPromptConfig, DifficultyLevel } from '../../types.js'

function contentRequirements(grade: number, level: DifficultyLevel): string {
  if (grade <= 4) {
    return `
СОДЕРЖАНИЕ ЗАДАНИЙ (русский язык, ${grade} класс):
- Задания должны содержать конкретные слова, предложения или короткие тексты (1-2 предложения) для работы
- ЗАПРЕЩЕНЫ абстрактные вопросы типа "Какой тип речи если..." — всегда давай конкретный пример`
  }
  if (grade <= 6) {
    return `
СОДЕРЖАНИЕ ЗАДАНИЙ (русский язык, ${grade} класс):
- Каждое задание ОБЯЗАНО содержать конкретный языковой материал: слова, словосочетания или предложения (2-3 шт.)
- Для заданий на анализ — давай предложения или мини-текст (2-3 предложения)
- ЗАПРЕЩЕНЫ абстрактные вопросы без примеров ("Какой тип... если...")`
  }
  // 7+ класс
  const textLength = grade <= 8 ? '2-4 предложения' : '3-6 предложений'
  const textSources = grade >= 9
    ? 'из художественной литературы, публицистики или научно-популярных текстов (можно адаптированные)'
    : 'из учебников, детской литературы или публицистики'
  const levelReqs = level === 'hard'
    ? `- Минимум 30% заданий должны включать РЕАЛЬНЫЕ текстовые фрагменты ${textSources}
- Включи задания на ТРАНСФОРМАЦИЮ текста (перестрой, перепиши в другом стиле/типе речи)
- Включи задания-СИТУАЦИИ (ты — редактор / журналист / ученик, которому нужно...)`
    : level === 'medium'
    ? `- Минимум 30% заданий должны включать текстовые фрагменты для анализа
- Тексты ${textSources}`
    : `- Минимум 20% заданий должны включать текстовые фрагменты для анализа`

  return `
СОДЕРЖАНИЕ ЗАДАНИЙ (русский язык, ${grade} класс) — КРИТИЧЕСКИ ВАЖНО:
- КАЖДОЕ задание ОБЯЗАНО содержать конкретный языковой материал для работы
- Для открытых вопросов и заданий на анализ: включи ТЕКСТОВЫЙ ФРАГМЕНТ (${textLength}) прямо в формулировку задания
- Для тестов: варианты ответов должны опираться на конкретные примеры (предложения, фрагменты), а НЕ на абстрактные определения
- Для соотнесения: в правом столбце должны быть ТЕКСТОВЫЕ ФРАГМЕНТЫ (${textLength} каждый), а НЕ отдельные слова
${levelReqs}

\u274C КАТЕГОРИЧЕСКИ ЗАПРЕЩЕНО: "Какой тип речи используется, если автор описывает..." — это абстрактный вопрос БЕЗ текста
\u2705 ПРАВИЛЬНО: "Прочитай фрагмент: \u00abЛес стоял тёмный и молчаливый. Огромные ели...\u00bb Определи тип речи и укажи языковые маркеры"

\u274C ЗАПРЕЩЕНО: "Соотнеси тип речи и пример" с одним предложением в правом столбце
\u2705 ПРАВИЛЬНО: "Соотнеси тип речи с текстовым фрагментом (3-4 предложения каждый), объясни выбор"`
}

export const russianPromptConfig: SubjectPromptConfig = {
  systemPrompt: `ПРЕДМЕТ: Русский язык (1-11 класс)

Особенности:
- Примеры только из современного литературного языка
- Все примеры орфографически и пунктуационно верны
- Термины соответствуют классу
- Никакого сленга и устаревшей лексики
- Для 7+ класса: задания ОБЯЗАНЫ содержать конкретный языковой материал (тексты, предложения, фрагменты)
- Абстрактные вопросы без примеров ЗАПРЕЩЕНЫ для любого класса`,

  contentRequirements,

  diversityHints: `
Для русского языка обязательно включи:
\u2022 Задания на знание ПРАВИЛ (сформулируй правило, выбери правильное объяснение)
\u2022 Задания на ОПРЕДЕЛЕНИЕ (найди подлежащее, определи часть речи, укажи тип)
\u2022 Задания на ПРИМЕНЕНИЕ (вставь букву, расставь знаки, исправь ошибку)
\u2022 Задания на АНАЛИЗ (объясни написание, сравни предложения, найди ошибку)`,
}
