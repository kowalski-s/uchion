import type { SubjectPromptConfig, DifficultyLevel } from '../../types.js'

function contentRequirements(grade: number, level: DifficultyLevel): string {
  // Complexity pyramid limits per difficulty
  let pyramidBlock: string
  if (level === 'hard') {
    pyramidBlock = `
ПИРАМИДА СЛОЖНОСТИ (ПОВЫШЕННЫЙ уровень):
Простые задачи (1 теорема, 1 шаг) — НЕ БОЛЕЕ 20% листа (максимум 2 штуки).
Средние задачи (2 теоремы, 2 шага) — 30-40% листа.
Сложные задачи (3+ шага, вспомогательные построения, комбинирование понятий) — МИНИМУМ 2 штуки на лист.
Пример сложной задачи: "В окружности даны две пересекающиеся хорды и угол между ними. Найди радиус окружности." (свойство хорд + вписанный угол + теорема синусов)`
  } else if (level === 'medium') {
    pyramidBlock = `
ПИРАМИДА СЛОЖНОСТИ (СРЕДНИЙ уровень):
Простые задачи (1 теорема, 1 шаг) — не более 30% листа.
Средние задачи (2 теоремы, 2 шага) — основная часть листа (50-60%).
Сложные задачи (3+ шага) — 10-20% для разнообразия.
Пример средней задачи: "Найди угол, используя и свойство вписанного угла, и свойство хорд"`
  } else {
    pyramidBlock = `
ПИРАМИДА СЛОЖНОСТИ (БАЗОВЫЙ уровень):
Простые задачи (1 теорема, 1 шаг) — основная часть листа, но с нарастанием.
Средние задачи (2 шага) — 20-30% для проверки понимания.
Пример простой задачи: "Найди ED, если AE=2, EB=8, CE=4 (свойство хорд)" — максимум 2 таких на лист`
  }

  return `
СОДЕРЖАНИЕ ЗАДАНИЙ (геометрия, ${grade} класс):
- Задачи должны содержать конкретные числовые данные (длины, углы, площади)
- Условие описывает геометрическую фигуру словами (без чертежа, но чётко)
- Для сложных задач: описание конфигурации пошагово (дано \u2192 найти \u2192 какие теоремы применить)

\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550
\u26D4 ЗАПРЕТ НА ОДНОТИПНЫЕ ЗАДАЧИ — КРИТИЧЕСКИ ВАЖНО \u26D4
\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550
Каждое задание ОБЯЗАНО задействовать ДРУГОЙ навык или ДРУГУЮ комбинацию теорем.
Одно и то же свойство/теорема = МАКСИМУМ 1 вычислительная задача + 1 тестовый вопрос.

\u274C ЗАПРЕЩЕНО: две задачи на одно свойство с разными числами.
   Пример: задача 1 "AE\u00d7EB = CE\u00d7ED, найди ED" + задача 2 "AE\u00d7EB = CE\u00d7ED, найди CE" — это ДУБЛЬ.
\u2705 ПРАВИЛЬНО: одна задача на свойство хорд (вычислительная) + один тест на это свойство (теоретический).

Перед добавлением каждой задачи сверься: какие теоремы/свойства уже использованы?
Если свойство уже задействовано в вычислительной задаче — следующая задача ОБЯЗАНА использовать ДРУГОЕ свойство или КОМБИНИРОВАТЬ это свойство с новым.
${pyramidBlock}`
}

export const geometryPromptConfig: SubjectPromptConfig = {
  systemPrompt: `ПРЕДМЕТ: Геометрия (7-11 класс)

Особенности:
- Чёткие геометрические формулировки
- Если нужен чертёж — описать словами условие (без рисунков)
- Теоремы применять строго по программе класса
- Обозначения точек заглавными буквами (A, B, C)`,

  contentRequirements,

  diversityHints: `
Для математических предметов обязательно включи:
\u2022 Задания на знание ФОРМУЛ (запиши формулу, выбери правильную формулу)
\u2022 Задания на ПОНИМАНИЕ (что изменится если..., верно ли что..., объясни)
\u2022 Задания на ВЫЧИСЛЕНИЕ (реши, найди, вычисли)
\u2022 Задания на АНАЛИЗ (найди ошибку, сравни способы решения, верно ли утверждение)`,
}
