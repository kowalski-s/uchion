import { z } from 'zod'

// =============================================================================
// Difficulty Level Types
// =============================================================================

export type DifficultyLevel = 'easy' | 'medium' | 'hard'

export const DifficultySchema = z.enum(['easy', 'medium', 'hard'])

export interface DifficultyConfig {
  id: DifficultyLevel
  name: string
  nameRu: string
}

// =============================================================================
// Difficulty Configurations
// =============================================================================

export const difficultyLevels: Record<DifficultyLevel, DifficultyConfig> = {
  easy: { id: 'easy', name: 'Easy', nameRu: 'Базовый' },
  medium: { id: 'medium', name: 'Medium', nameRu: 'Средний' },
  hard: { id: 'hard', name: 'Hard', nameRu: 'Повышенный' },
}

// =============================================================================
// Math prompts (1-6 класс)
// =============================================================================

const MATH_PROMPTS: Record<number, Record<DifficultyLevel, string>> = {
  1: {
    easy: `Уровень: БАЗОВЫЙ (1 класс)
Требования:
- Сложение и вычитание в пределах 10
- Счёт предметов
- Сравнение чисел (больше/меньше)
- Один шаг решения

Примеры заданий:
- "Сколько будет 3 + 4?"
- "Какое число больше: 5 или 8?"
- "На ветке сидели 6 птиц. 2 улетели. Сколько осталось?"`,

    medium: `Уровень: СРЕДНИЙ (1 класс)
Требования:
- Сложение и вычитание в пределах 20
- Задачи в одно действие с простым условием
- Сравнение выражений
- Часть заданий должна комбинировать счёт предметов с простым сложением/вычитанием

Примеры заданий:
- "Вычисли: 12 + 5"
- "У Маши 8 конфет, у Пети на 3 больше. Сколько конфет у Пети?" (сравнение + сложение)
- "Сравни: 9 + 2 ... 15 - 4" (сравнение + вычисления)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (1 класс)
Требования:
- Задачи в два действия, комбинирующие сложение И вычитание в одной задаче
- Нахождение неизвестного компонента (обратные операции к сложению и вычитанию)
- Логические задачи на рассуждение, комбинирующие сравнение чисел + счёт
- Задания должны сочетать несколько навыков: например, текстовая задача где нужно И сложить, И вычесть, И сравнить

Примеры заданий:
- "У Вани было 10 яблок. Он отдал 3 и получил ещё 5. Сколько стало?" (сложение + вычитание в 2 действия)
- "Какое число нужно прибавить к 7, чтобы получить 15?" (обратная операция)
- "Катя старше Маши на 2 года, но младше Оли на 3 года. Оле 10 лет. Сколько лет Маше?" (логика + вычитание + сложение)`,
  },

  2: {
    easy: `Уровень: БАЗОВЫЙ (2 класс)
Требования:
- Сложение и вычитание в пределах 100 (без перехода через десяток)
- Табличное умножение на 2, 3
- Простые задачи в одно действие

Примеры заданий:
- "Вычисли: 34 + 25"
- "Сколько будет 3 × 4?"
- "В классе 12 мальчиков и 14 девочек. Сколько всего учеников?"`,

    medium: `Уровень: СРЕДНИЙ (2 класс)
Требования:
- Сложение и вычитание с переходом через десяток
- Табличное умножение и деление (2-5)
- Задачи в 1-2 действия, комбинирующие разные арифметические операции
- Часть заданий должна требовать и сложение/вычитание (1кл), и умножение в одной задаче

Примеры заданий:
- "Вычисли: 48 + 37"
- "Купили 3 пачки печенья по 8 штук и ещё 5 штук отдельно. Сколько всего печенья?" (умножение + сложение)
- "В каждой из 4 коробок по 6 карандашей. Раздали 10 карандашей. Сколько осталось?" (умножение + вычитание)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (2 класс)
Требования:
- Задачи в 2-3 действия, обязательно комбинирующие умножение/деление с +/- из 1 класса
- Нахождение неизвестного множителя/делителя
- Логические задачи, закономерности, комбинирующие несколько навыков
- Задания должны сочетать: порядок действий + разные операции + сравнение

Примеры заданий:
- "В двух коробках 24 карандаша. В первой на 4 больше, чем во второй. Сколько в каждой?" (подбор + сложение + проверка)
- "Купили 5 тетрадей по 4 рубля и 3 ручки. За всё заплатили 35 рублей. Сколько стоит ручка?" (умножение + вычитание + деление)
- "Продолжи ряд: 2, 4, 7, 11, 16, ..." (закономерность + сложение)`,
  },

  3: {
    easy: `Уровень: БАЗОВЫЙ (3 класс)
Требования:
- Табличное умножение и деление (вся таблица)
- Внетабличное умножение и деление круглых чисел
- Простые задачи на умножение/деление

Примеры заданий:
- "Вычисли: 7 × 8"
- "Найди: 60 : 3"
- "В 5 одинаковых коробках 45 конфет. Сколько конфет в одной коробке?"`,

    medium: `Уровень: СРЕДНИЙ (3 класс)
Требования:
- Внетабличное умножение и деление
- Порядок действий (2-3 действия), комбинирующие все 4 арифметические операции
- Задачи на приведение к единице, где нужно и умножать, и складывать/вычитать
- Часть заданий должна использовать табличное умножение (2кл) в составе более сложных выражений

Примеры заданий:
- "Найди значение: 36 + 48 : 6" (порядок действий + деление + сложение)
- "За 4 тетради заплатили 52 рубля. Сколько стоят 7 таких тетрадей?" (деление + умножение)
- "В магазине купили 3 кг яблок по 84 рубля за кг и заплатили 500 рублей. Сколько сдачи получили?" (умножение + вычитание)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (3 класс)
Требования:
- Деление с остатком, комбинирование с табличным умножением и порядком действий
- Задачи в 3-4 действия, обязательно использующие навыки 1-2 классов (все 4 операции, сравнение, порядок действий)
- Нестандартные задачи, где нужно комбинировать: умножение/деление + сложение/вычитание + логику
- Задания с подвохом на порядок действий, со скобками

Примеры заданий:
- "При делении числа на 7 получили частное 5 и остаток 3. Какое это число?" (деление с остатком + умножение + сложение)
- "Туристы прошли за 3 дня 54 км. В первый день прошли 20 км, во второй — на 4 км меньше. Сколько прошли в третий?" (вычитание + сложение + вычитание)
- "Расставь скобки, чтобы равенство стало верным: 8 + 12 : 4 - 2 = 3" (порядок действий + все операции)`,
  },

  4: {
    easy: `Уровень: БАЗОВЫЙ (4 класс)
Требования:
- Умножение и деление многозначных чисел на однозначное
- Нахождение периметра и площади прямоугольника
- Единицы измерения (длина, масса, время)

Примеры заданий:
- "Вычисли: 234 × 3"
- "Найди периметр прямоугольника со сторонами 8 см и 5 см"
- "Вырази в минутах: 2 ч 15 мин"`,

    medium: `Уровень: СРЕДНИЙ (4 класс)
Требования:
- Умножение и деление на двузначное число
- Составные задачи на движение, работу, комбинирующие с единицами измерения и периметром/площадью
- Дроби (сравнение, сложение с одинаковым знаменателем)
- Часть заданий должна требовать перевод единиц измерения (3кл) + вычисления в несколько шагов

Примеры заданий:
- "Вычисли: 1428 : 28"
- "Автомобиль проехал 240 км за 4 часа. Сколько времени ему понадобится, чтобы проехать 360 км с той же скоростью?" (скорость + деление + умножение)
- "Периметр прямоугольника 48 см. Длина на 4 см больше ширины. Найди площадь" (периметр + площадь + подбор)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (4 класс)
Требования:
- Задачи на встречное/противоположное движение, комбинирующие с единицами времени и длины (3кл)
- Задачи на совместную работу, где нужны дроби + деление + умножение
- Нестандартные задачи, олимпиадного типа, синтезирующие: площадь/периметр + движение, дроби + все 4 операции
- Задания ОБЯЗАНЫ комбинировать материал 1-4 классов: все операции + единицы измерения + дроби + геометрические величины

Примеры заданий:
- "Два поезда вышли навстречу из городов на расстоянии 420 км. Скорости 60 и 80 км/ч. Через сколько часов они встретятся? На каком расстоянии от первого города?" (движение + все операции)
- "Садовый участок имеет форму прямоугольника 30м × 20м. Дорожка шириной 1м проходит по периметру внутри. Найди площадь дорожки" (площадь + периметр + вычитание площадей)
- "Один мастер делает деталь за 6 минут, другой за 4 минуты. Сколько деталей они сделают вместе за 1 час?" (работа + дроби + перевод единиц)`,
  },

  5: {
    easy: `Уровень: БАЗОВЫЙ (5 класс)
Требования:
- Натуральные числа: действия с ними + проверка результата обратным действием или прикидкой
- Обыкновенные дроби: сравнение с обоснованием (через приведение к общему знаменателю или к десятичным), классификация дробей (правильные/неправильные)
- Десятичные дроби: запись, сравнение, взаимный перевод с обыкновенными — с объяснением способа
- Каждое задание требует НЕ просто вычисления, а сравнения, проверки или обоснования

Примеры заданий:
- "Вычисли 3456 + 2789 и проверь результат вычитанием. Оцени без вычислений: результат ближе к 6000 или к 7000?" (вычисление + проверка + прикидка)
- "Сравни дроби 3/5 и 4/7. Объясни способ сравнения. Какая из них ближе к 1?" (сравнение + обоснование + оценка)
- "Запиши 3/10 и 7/4 в виде десятичных дробей. Какая из них правильная, какая неправильная? Объясни" (перевод + классификация + объяснение)`,

    medium: `Уровень: СРЕДНИЙ (5 класс)
Требования:
- Сложение и вычитание дробей с разными знаменателями
- Действия с десятичными дробями
- Уравнения (нахождение неизвестного), комбинирующие дроби с навыками 4 класса (задачи на движение, площадь)
- Часть заданий должна сочетать обыкновенные и десятичные дроби, или дроби + уравнения

Примеры заданий:
- "Вычисли: 2/3 + 1/4 и запиши результат в виде десятичной дроби" (обыкновенные + десятичные дроби)
- "Скорость велосипедиста 12,5 км/ч. За какое время он проедет 37,5 км?" (десятичные дроби + задача на движение из 4кл)
- "Реши уравнение: x + 3,5 = 8,2. Проверь ответ подстановкой"`,

    hard: `Уровень: ПОВЫШЕННЫЙ (5 класс)
Требования:
- Сложные задачи на дроби (нахождение части от числа и числа по его части) с использованием всех 4 операций (1-4кл)
- Комбинирование обыкновенных и десятичных дробей + проценты + уравнения
- Задачи, где нужно: перевести дробь + выполнить действия + решить задачу на движение/площадь из 4 класса
- Задания ОБЯЗАНЫ синтезировать: дроби + задачи на движение/работу (4кл) + единицы измерения (3-4кл)

Примеры заданий:
- "Турист прошёл 2/5 пути в первый день и 0,25 всего пути во второй. Осталось 14 км. Найди весь путь и расстояние каждого дня" (обыкновенная + десятичная дробь + 3 шага)
- "В бочке было несколько литров воды. Отлили 40% воды, потом 1/3 остатка. Осталось 12 л. Сколько было?" (проценты + дроби + обратный ход)
- "Площадь прямоугольника 7,5 м². Длина 3 3/4 м. Найди периметр" (десятичные + обыкновенные дроби + площадь/периметр из 4кл)`,
  },

  6: {
    easy: `Уровень: БАЗОВЫЙ (6 класс)
Требования:
- Действия с положительными и отрицательными числами: вычисление + объяснение правила знаков, сравнение выражений с разными знаками
- Пропорции: нахождение неизвестного + проверка пропорции (произведение крайних = произведению средних)
- Координатная плоскость: определение координат + определение четверти + объяснение знаков координат
- Каждое задание требует сравнения, классификации или проверки, а НЕ только вычисления

Примеры заданий:
- "Вычисли: -8 + 15 и 15 + (-8). Объясни, почему результаты одинаковые. Какое правило сложения чисел с разными знаками ты применил?" (вычисление + обоснование правила)
- "Найди x: 3/5 = x/20. Проверь ответ подстановкой. Объясни, как связаны крайние и средние члены пропорции" (нахождение + проверка + объяснение свойства)
- "Точка A(3, -2). В какой четверти она находится? Какие знаки координат у точек в каждой четверти? Назови точку, симметричную A относительно оси Ox" (координаты + классификация + симметрия)`,

    medium: `Уровень: СРЕДНИЙ (6 класс)
Требования:
- Проценты (нахождение процента от числа, числа по проценту), комбинирование с дробями из 5 класса
- Пропорции в задачах, связанные с движением/работой (4кл)
- Действия с рациональными числами, включающие и обыкновенные, и десятичные дроби (5кл)
- Часть заданий должна сочетать отрицательные числа + дроби + проценты

Примеры заданий:
- "Турист прошёл 35% от 240 км. Сколько ему осталось, если скорость 4,5 км/ч?" (проценты + десятичные дроби + задача на движение)
- "Для варенья взяли ягоды и сахар в отношении 2:3. Сколько нужно сахара на 4 кг ягод?" (пропорции)
- "Вычисли: (-2/3) × 1,5 + 1/2 и запиши результат в виде обыкновенной дроби" (рациональные числа + обыкновенные/десятичные)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (6 класс)
Требования:
- Сложные задачи на проценты (сложные проценты, изменение на проценты), комбинирующие с дробями (5кл) и пропорциями
- Задачи на отношения и пропорции в несколько действий + задачи на движение/работу (4кл)
- Олимпиадные задачи, синтезирующие: рациональные числа + проценты + дроби + делимость
- Задания ОБЯЗАНЫ комбинировать темы 4-6 классов: проценты + дроби + пропорции + отрицательные числа + задачи на движение/площадь

Примеры заданий:
- "Цена товара выросла на 20%, потом снизилась на 20%. На сколько процентов изменилась цена? Если начальная цена была 1500 руб., сколько составила разница?" (проценты + вычисления с десятичными)
- "Два велосипедиста выехали навстречу. Первый проехал 2/5 пути, второй — 35% пути. Осталось 12 км. Найди расстояние" (дроби + проценты + движение из 4кл)
- "Трое друзей набрали 40 баллов. Первый — на 4 больше второго, второй — в 2 раза больше третьего. Какой процент от общего числа набрал каждый?" (подбор + проценты + дроби)`,
  },
}

// =============================================================================
// Algebra prompts (7-11 класс)
// =============================================================================

const ALGEBRA_PROMPTS: Record<number, Record<DifficultyLevel, string>> = {
  7: {
    easy: `Уровень: БАЗОВЫЙ (7 класс)
Требования:
- Линейные уравнения: решение + проверка подстановкой, объяснение каждого шага преобразования
- Раскрытие скобок, приведение подобных: упрощение + объяснение, какие слагаемые подобные и почему
- Степень с натуральным показателем: вычисление + обоснование правила (умножение/деление степеней)
- Каждое задание требует НЕ только вычисления, а проверки результата и объяснения применённого правила

Примеры заданий:
- "Реши уравнение 2x + 5 = 11 и проверь решение подстановкой. Объясни, какое свойство равенства ты использовал на каждом шаге" (решение + проверка + обоснование)
- "Упрости 3(a + 2) - (a - 1) двумя способами: раскрыв скобки и подставив a = 3 в исходное и упрощённое. Совпали ли результаты?" (упрощение + проверка подстановкой)
- "Вычисли 2³ × 2⁴. Объясни, почему 2³ × 2⁴ = 2⁷, а не 2¹². Какое правило действий со степенями ты применил?" (вычисление + объяснение правила + разбор типичной ошибки)`,

    medium: `Уровень: СРЕДНИЙ (7 класс)
Требования:
- Системы линейных уравнений (подстановка, сложение)
- Линейная функция, её график
- Формулы сокращённого умножения

Примеры заданий:
- "Реши систему: x + y = 7, 2x - y = 5"
- "Построй график функции y = 2x - 3"
- "Разложи на множители: a² - 9"`,

    hard: `Уровень: ПОВЫШЕННЫЙ (7 класс)
Требования:
- Задачи на составление уравнений/систем с комбинацией нескольких навыков
- Нестандартные задачи с формулами сокращённого умножения
- Исследование линейной функции, комбинирование со степенями и многочленами
- Задания ОБЯЗАНЫ синтезировать несколько тем: системы уравнений + многочлены, степени + линейные функции и т.д.

Примеры заданий:
- "Двое рабочих изготовили вместе 72 детали. Первый работал 4 часа, второй 6 часов. Первый изготавливает в час на 2 детали больше. Сколько деталей делает каждый за час?" (система уравнений + текстовая задача)
- "Упрости (a + b)² - (a - b)² и найди значение при a = 2³, b = 3²" (формулы сокращённого умножения + степени)
- "При каком значении k графики y = kx + 3 и y = 2x - 1 пересекаются в точке с ординатой 5?" (линейная функция + система)`,
  },

  8: {
    easy: `Уровень: БАЗОВЫЙ (8 класс)
Требования:
- Квадратные уравнения: решение по формуле + проверка обоих корней подстановкой + анализ дискриминанта (что означает D > 0, D = 0, D < 0)
- Свойства квадратного корня: упрощение + объяснение, какое свойство использовано (вынесение множителя из-под корня)
- Квадратичная функция: нахождение вершины + определение направления ветвей с обоснованием (знак коэффициента a)
- Каждое задание требует решения И анализа: "реши и объясни", "вычисли и проверь", "найди и определи"

Примеры заданий:
- "Реши уравнение x² - 5x + 6 = 0. Проверь оба корня подстановкой. Что означает знак дискриминанта для количества корней?" (решение + проверка + анализ дискриминанта)
- "Упрости √50 - √8. Объясни, как ты вынес множитель из-под корня. Какое свойство корня использовано?" (упрощение + объяснение правила)
- "Найди вершину параболы y = x² - 4x + 3. Куда направлены ветви и почему? Какое наименьшее значение принимает функция?" (вершина + направление + анализ экстремума)`,

    medium: `Уровень: СРЕДНИЙ (8 класс)
Требования:
- Теорема Виета, разложение на множители (с использованием формул 7кл)
- Квадратные неравенства
- Дробно-рациональные уравнения
- Часть заданий должна требовать предварительных алгебраических преобразований (вынесение за скобки, раскрытие скобок из 7кл)

Примеры заданий:
- "Не решая уравнение x² - 7x + 12 = 0, найди сумму и произведение корней. Составь уравнение с корнями, в 2 раза большими" (Виета + составление уравнения)
- "Реши неравенство: x² - 4x - 5 < 0"
- "Упрости дробь (x²-9)/(x²+6x+9) и найди значение при x = 4" (дроби + формулы сокращённого умножения 7кл)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (8 класс)
Требования:
- Уравнения с параметром (комбинация дискриминанта + анализ)
- Модуль в уравнениях, комбинирование с алгебраическими дробями
- Сложные задачи: квадратичная функция + разложение многочленов (7кл) + квадратные корни
- Задания ОБЯЗАНЫ синтезировать текущие темы 8кл с материалом 7кл (одночлены, многочлены, степени, линейные функции)

Примеры заданий:
- "При каких значениях a уравнение x² + ax + 4 = 0 имеет два различных корня?" (дискриминант + неравенство)
- "Упрости алгебраическую дробь (x²-4)/(x²-4x+4) и найди её значение при x = √3 + 2" (дроби + формулы сокращённого умножения из 7кл + корни)
- "Найди наименьшее значение функции y = x² - 6x + 10 и определи, при каком x графики y = x² - 6x + 10 и y = 2x - 5 пересекаются" (квадратичная + линейная функция из 7кл)`,
  },

  9: {
    easy: `Уровень: БАЗОВЫЙ (9 класс, уровень ОГЭ часть 1)
Требования:
- Прогрессии: нахождение n-го члена + определение типа прогрессии (арифметическая/геометрическая) по данным членам + связь с суммой
- Системы уравнений второй степени: решение + обоснование выбора метода (подстановка vs сложение) + проверка
- Область определения функции: нахождение + объяснение ограничений (почему нельзя извлекать корень из отрицательного, делить на 0)
- Задания должны требовать понимания связей между понятиями, а не изолированного применения формул

Примеры заданий:
- "Дана последовательность: 3, 7, 11, 15... Определи тип прогрессии, найди d и 10-й член. Объясни, как проверить ответ, не вычисляя все члены" (определение типа + формула + обоснование проверки)
- "Реши систему x + y = 5, xy = 6. Объясни: почему удобно использовать подстановку? Проверь оба решения" (решение + выбор метода + проверка)
- "Найди область определения y = √(x - 2). Объясни, почему x ≥ 2. Что произойдёт с графиком, если заменить на y = √(x + 2)?" (область определения + обоснование + анализ сдвига)`,

    medium: `Уровень: СРЕДНИЙ (9 класс, уровень ОГЭ части 1-2)
Требования:
- Сумма членов прогрессии, комбинирование с нахождением элементов прогрессии
- Иррациональные уравнения с обязательной проверкой (отсев посторонних корней)
- Неравенства методом интервалов + анализ знака на каждом промежутке

Примеры заданий:
- "Найди сумму первых 20 членов арифметической прогрессии (a₁ = 5, d = 3). Сколько членов нужно взять, чтобы сумма превысила 500?" (сумма + обратная задача)
- "Реши √(x + 3) = x - 3. Объясни, почему необходима проверка. Есть ли посторонние корни?" (решение + анализ посторонних корней)
- "Реши неравенство (x-1)(x+2)/(x-3) > 0. Покажи знаки на числовой прямой, объясни выбор знака на каждом интервале" (метод интервалов + обоснование)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (9 класс)
Требования:
- Задачи на прогрессии с составлением систем уравнений
- Иррациональные уравнения с проверкой, комбинирование с квадратными уравнениями (8кл)
- Задачи ОГЭ части 2, требующие синтеза тем 7-9 классов
- Задания ОБЯЗАНЫ комбинировать: прогрессии + системы уравнений, функции + неравенства + графики, комбинаторика + уравнения

Примеры заданий:
- "Сумма трёх чисел, образующих геометрическую прогрессию, равна 21. Если к ним прибавить 1, 2 и 3, то получится арифметическая прогрессия. Найди эти числа" (обе прогрессии + система уравнений)
- "Реши уравнение √(2x + 1) + √(x - 1) = 3 и проверь, принадлежат ли корни области определения функции y = 1/(x²-4)" (иррациональное уравнение + дроби 8кл + область определения)
- "При каких значениях параметра a система уравнений x + y = a, xy = a + 2 имеет два положительных решения?" (параметр + система + теорема Виета 8кл)`,
  },

  10: {
    easy: `Уровень: БАЗОВЫЙ (10 класс, уровень ЕГЭ часть 1 базовый)
Требования:
- Тригонометрические функции: вычисление значений + объяснение через единичную окружность, связь sin/cos/tg между собой
- Простейшие тригонометрические уравнения: решение на заданном промежутке + объяснение, почему решений несколько (периодичность)
- Степенная функция: область определения + сравнение свойств при разных показателях (чётный/нечётный, положительный/отрицательный)
- Задания требуют понимания СВЯЗЕЙ: между функциями, между графиком и формулой, между свойствами

Примеры заданий:
- "Вычисли sin 30° + cos 60°. Объясни, почему sin 30° = cos 60°. В каких ещё случаях sin α = cos β?" (вычисление + связь синуса и косинуса + обобщение)
- "Реши sin x = 1/2 на промежутке [0; 2π]. Сколько решений и почему? Покажи их на единичной окружности" (уравнение + анализ количества решений + визуализация)
- "Сравни области определения и графики y = x² и y = x⁻². Чем они различаются? Почему у x⁻² нет значения при x = 0?" (сравнение + анализ свойств)`,

    medium: `Уровень: СРЕДНИЙ (10 класс)
Требования:
- Тригонометрические формулы (сложения, двойного угла)
- Тригонометрические уравнения (сводящиеся к простейшим)
- Преобразование тригонометрических выражений

Примеры заданий:
- "Упрости: sin²α + cos²α + tan α × cot α"
- "Реши уравнение: 2sin²x - 3sin x + 1 = 0"
- "Вычисли: sin 75° (используя формулу сложения)"`,

    hard: `Уровень: ПОВЫШЕННЫЙ (10 класс)
Требования:
- Сложные тригонометрические уравнения, комбинирование с алгебраическими преобразованиями (7-9кл)
- Отбор корней на промежутке, связь с неравенствами (8-9кл)
- Задачи ЕГЭ профильного уровня, синтезирующие тригонометрию + квадратные уравнения + степени
- Задания ОБЯЗАНЫ комбинировать тригонометрию с ранее изученным: квадратные уравнения, неравенства, свойства функций

Примеры заданий:
- "Реши уравнение sin x + sin 2x + sin 3x = 0 и отбери корни на [-π; 2π]" (тригонометрия + формулы + отбор)
- "Найди все корни уравнения 2cos²x - 5cos x + 2 = 0 на [-π; π], используя замену t = cos x" (тригонометрия + квадратное уравнение 8кл + отбор)
- "Исследуй функцию y = sin²x - 2sin x на монотонность и найди экстремумы" (тригонометрия + свойства функций 9кл)`,
  },

  11: {
    easy: `Уровень: БАЗОВЫЙ (11 класс, уровень ЕГЭ часть 1 базовый)
Требования:
- Производная: нахождение + объяснение геометрического смысла (касательная), определение знака производной по графику функции
- Первообразная: нахождение + проверка дифференцированием + объяснение, почему ответ не единственный (+ C)
- Показательные и логарифмические выражения: вычисление + обоснование применённого свойства, связь между показательной и логарифмической функциями
- Задания требуют понимания СМЫСЛА операций, а не только формального вычисления

Примеры заданий:
- "Найди производную y = x³ - 2x + 1. Что означает f'(2) геометрически? В каких точках f'(x) = 0 и что это значит для графика?" (производная + геометрический смысл + анализ)
- "Найди первообразную f(x) = 3x² и проверь дифференцированием. Почему у первообразной есть + C? Какая первообразная проходит через точку (1; 5)?" (первообразная + проверка + начальное условие)
- "Вычисли log₂ 8 + log₃ 27. Какие свойства логарифмов ты использовал? Верно ли, что log₂ 8 + log₃ 27 = log₆ 216?" (вычисление + обоснование + анализ ошибки)`,

    medium: `Уровень: СРЕДНИЙ (11 класс)
Требования:
- Производная сложной функции
- Показательные и логарифмические уравнения
- Применение производной (касательная, экстремумы)

Примеры заданий:
- "Найди производную: y = sin(2x + 1)"
- "Реши уравнение: 3^(x+1) = 27"
- "Найди точки экстремума функции y = x³ - 3x"`,

    hard: `Уровень: ПОВЫШЕННЫЙ (11 класс)
Требования:
- Сложные показательные/логарифмические уравнения с комбинацией методов (замена, логарифмирование + квадратное уравнение)
- Исследование функции с помощью производной, комбинирование с тригонометрией (10кл) и алгеброй (8-9кл)
- Задачи ЕГЭ профильного уровня (№ 12, 14, 18), требующие синтеза всего курса 7-11кл
- Задания ОБЯЗАНЫ использовать материал предыдущих классов: тригонометрию, квадратные уравнения, прогрессии, неравенства

Примеры заданий:
- "Реши уравнение log₂(x+1) + log₂(x+4) = log₂(x+16) и проверь, что корни удовлетворяют ОДЗ" (логарифмы + квадратное уравнение 8кл + ОДЗ 9кл)
- "Найди наибольшее значение y = x³ - 6x² + 9x + 2 на [0; 4] и определи промежутки убывания" (производная + полное исследование функции 9кл)
- "Реши систему: log₃(x) + log₃(y) = 2, x² + y² = 10" (логарифмы + система уравнений 9кл + свойства степеней)`,
  },
}

// =============================================================================
// Geometry prompts (7-11 класс)
// =============================================================================

const GEOMETRY_PROMPTS: Record<number, Record<DifficultyLevel, string>> = {
  7: {
    easy: `Уровень: БАЗОВЫЙ (7 класс)
Требования:
- Углы: нахождение смежных/вертикальных + объяснение, ПОЧЕМУ углы связаны (свойство смежных, свойство вертикальных)
- Признаки равенства треугольников: определение применимого признака + обоснование (какие элементы даны и какой признак подходит)
- Свойства равнобедренного треугольника: нахождение углов + объяснение, почему углы при основании равны
- Каждое задание требует обоснования: "найди И объясни почему", "определи И назови признак"

Примеры заданий:
- "Один из смежных углов равен 70°. Найди второй угол и вертикальный к нему. Объясни, какими свойствами ты воспользовался" (нахождение + обоснование двух свойств)
- "В треугольниках ABC и DEF: AB = DE, BC = EF, ∠B = ∠E. Равны ли треугольники? По какому признаку? Следует ли из этого, что AC = DF?" (признак + обоснование + вывод)
- "В равнобедренном треугольнике угол при вершине 40°. Найди углы при основании. Объясни, почему они равны. Что изменится, если угол при вершине будет 90°?" (нахождение + объяснение свойства + анализ частного случая)`,

    medium: `Уровень: СРЕДНИЙ (7 класс)
Требования:
- Задачи на доказательство равенства треугольников, комбинирующие несколько признаков
- Медиана, биссектриса, высота — задачи с вычислением + доказательством
- Параллельные прямые и секущая + свойства треугольников
- Часть заданий должна комбинировать: углы (смежные/вертикальные) + признаки равенства + параллельные прямые

Примеры заданий:
- "Докажи, что медиана равнобедренного треугольника к основанию является и высотой" (свойства + доказательство)
- "Две параллельные прямые пересечены секущей. Один угол 65°. Найди все 8 углов и объясни, какие свойства использовал" (параллельные + смежные/вертикальные)
- "В треугольнике ABC проведена высота BH. Угол A = 50°, угол C = 70°. Найди углы треугольников ABH и BCH" (сумма углов + свойства высоты)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (7 класс)
Требования:
- Задачи на построение, требующие нескольких признаков равенства одновременно
- Комбинирование: признаки равенства + параллельные прямые + свойства равнобедренного треугольника + медиана/биссектриса/высота
- Нестандартные конфигурации, где нужно увидеть вспомогательные треугольники
- Задания ОБЯЗАНЫ синтезировать несколько тем 7 класса в одной задаче

Примеры заданий:
- "В треугольнике ABC биссектриса AD делит сторону BC. Через D проведена прямая, параллельная AB. Докажи, что получившийся треугольник равнобедренный" (биссектриса + параллельные + равнобедренный)
- "На сторонах угла от вершины отложены равные отрезки. Докажи, что любая точка биссектрисы равноудалена от концов этих отрезков" (биссектриса + признаки равенства)
- "Через точку пересечения медиан треугольника проведена прямая, параллельная основанию. Найди отрезки, на которые она делится сторонами" (медианы + параллельные + подобие)`,
  },

  8: {
    easy: `Уровень: БАЗОВЫЙ (8 класс)
Требования:
- Свойства четырёхугольников: нахождение элементов + объяснение, какое свойство используется и почему оно работает
- Теорема Пифагора: применение + проверка (подстановка в a² + b² = c²), определение вида треугольника по сторонам
- Площадь: вычисление + объяснение формулы (почему S = ½ah для треугольника), сравнение площадей фигур
- Каждое задание: "найди + проверь" или "вычисли + объясни формулу" или "определи + обоснуй"

Примеры заданий:
- "В прямоугольнике одна сторона 6 см, диагональ 10 см. Найди вторую сторону. Проверь по теореме Пифагора. Могут ли стороны прямоугольника быть больше диагонали? Почему?" (Пифагор + проверка + анализ)
- "Катеты прямоугольного треугольника 5 и 12. Найди гипотенузу. Определи: является ли треугольник со сторонами 5, 12, 14 прямоугольным? Как проверить?" (Пифагор + обратная теорема + проверка)
- "Найди площадь треугольника с основанием 8 и высотой 5. Объясни: если основание увеличить вдвое, а высоту уменьшить вдвое, изменится ли площадь? Почему?" (площадь + анализ зависимости)`,

    medium: `Уровень: СРЕДНИЙ (8 класс)
Требования:
- Площади четырёхугольников, комбинирование с теоремой Пифагора
- Подобие треугольников + вычисление элементов через признаки равенства (7кл)
- Средняя линия трапеции + площадь трапеции в одной задаче
- Часть заданий должна требовать: найти элемент через Пифагора → вычислить площадь → применить свойство

Примеры заданий:
- "В прямоугольной трапеции основания 6 и 10, боковая сторона 5. Найди площадь" (Пифагор + площадь трапеции)
- "Отношение сторон подобных треугольников 2:3. Площадь меньшего 12. Найди площадь большего и отношение периметров" (подобие + площадь)
- "В параллелограмме стороны 5 и 8, высота к большей стороне 4. Найди площадь и вторую высоту" (площадь + свойства параллелограмма)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (8 класс)
Требования:
- Комбинированные задачи: площади + теорема Пифагора + подобие + свойства четырёхугольников (7кл: признаки равенства)
- Вписанные/описанные четырёхугольники + вычисление площадей и элементов
- Задачи, где нужно: установить подобие → найти стороны → вычислить площадь → применить теорему
- Задания ОБЯЗАНЫ синтезировать: площади + Пифагор + подобие + свойства из 7кл (равенство треугольников, параллельные прямые)

Примеры заданий:
- "Диагонали ромба 6 и 8. Найди сторону (через Пифагора), площадь (через диагонали) и радиус вписанной окружности" (ромб + Пифагор + площадь + вписанная)
- "В трапеции ABCD диагонали пересекаются в O. S(AOB)=8. Докажи подобие △AOB и △COD, найди отношение сторон, если BC/AD=1/2, и вычисли S(трапеции)" (подобие + площади + свойства)
- "В параллелограмме ABCD точка M — середина BC. AM пересекает BD в точке K. Найди AK:KM и BK:KD" (параллельные + подобие + медиана из 7кл)`,
  },

  9: {
    easy: `Уровень: БАЗОВЫЙ (9 класс, уровень ОГЭ часть 1)
Требования:
- Тригонометрия прямоугольного треугольника: нахождение sin/cos/tg + связь между ними (sin²α + cos²α = 1), проверка результата
- Длина окружности, площадь круга: вычисление + объяснение связи формул (обе через π и r), сравнение окружности и круга
- Векторы: сложение + геометрический смысл (правило параллелограмма/треугольника), связь координат вектора с точками
- Задания требуют понимания связей между понятиями, а не изолированного применения формул

Примеры заданий:
- "В прямоугольном треугольнике катет 3, гипотенуза 5. Найди sin и cos острого угла. Проверь: sin²α + cos²α = 1. Найди второй катет (через Пифагора из 8кл)" (тригонометрия + проверка + связь с Пифагором)
- "Найди длину окружности и площадь круга с радиусом 7. Как изменятся оба значения, если радиус удвоить? Во сколько раз?" (вычисление + анализ зависимости от радиуса)
- "Найди сумму векторов a(2, 3) и b(-1, 4). Чему равна длина каждого вектора и вектора суммы? Верно ли, что |a + b| = |a| + |b|?" (сложение + длина + анализ неравенства треугольника)`,

    medium: `Уровень: СРЕДНИЙ (9 класс)
Требования:
- Теоремы синусов и косинусов, комбинирование с площадями (8кл) и теоремой Пифагора (8кл)
- Вписанная и описанная окружности + вычисление площадей/периметров
- Скалярное произведение векторов + применение к нахождению углов и длин
- Часть заданий должна использовать: тригонометрия → нахождение сторон → площадь (8кл)

Примеры заданий:
- "В треугольнике стороны 5 и 8, угол между ними 60°. Найди третью сторону и площадь" (теорема косинусов + формула площади)
- "В прямоугольном треугольнике с катетами 6 и 8 найди радиусы вписанной и описанной окружностей" (Пифагор 8кл + вписанная/описанная)
- "Даны точки A(1,1), B(4,5), C(7,1). Найди угол B через скалярное произведение и площадь треугольника" (векторы + площадь)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (9 класс)
Требования:
- Комбинированные задачи: окружности + площади (8кл) + подобие (8кл) + тригонометрия
- Задачи ОГЭ части 2, синтезирующие весь курс 7-9 классов
- Задачи с координатным/векторным методом + классическая геометрия
- Задания ОБЯЗАНЫ синтезировать: теоремы синусов/косинусов + площади (8кл) + подобие (8кл) + признаки равенства (7кл) + окружности

Примеры заданий:
- "В △ABC вписана окружность r=2, периметр=20. Найди площадь. Если AB=6, AC=8, найди BC и все три отрезка касательных" (вписанная + площадь + система уравнений)
- "В трапеции ABCD (AD‖BC) проведены диагонали. S(AOB)=4, S(BOC)=9. Найди S(трапеции) через подобие треугольников AOB и COD" (подобие 8кл + площади 8кл + свойства трапеции)
- "Докажи векторами, что медианы треугольника пересекаются в одной точке и делятся ею в отношении 2:1" (векторы + медианы 7кл + доказательство)`,
  },

  10: {
    easy: `Уровень: БАЗОВЫЙ (10 класс, уровень ЕГЭ часть 1 базовый)
Требования:
- Параллельность в пространстве: определение взаимного расположения + обоснование по признакам, анализ верности утверждений
- Углы между прямыми в пространстве: нахождение + объяснение, через какие планиметрические фигуры (из 7-9кл) выполнены вычисления
- Элементы многогранников: подсчёт элементов + объяснение связей (формула Эйлера), сравнение свойств разных многогранников
- Задания комбинируют стереометрию с планиметрией 7-9кл и требуют обоснования

Примеры заданий:
- "Прямая параллельна плоскости. Верно ли, что она параллельна любой прямой в этой плоскости? Обоснуй ответ и приведи контрпример, если утверждение ложно" (анализ утверждения + обоснование + контрпример)
- "Найди угол между диагоналями двух смежных граней куба с ребром 1. Какую планиметрическую фигуру ты рассматриваешь? Какую теорему применяешь?" (нахождение + объяснение метода + связь с планиметрией 8кл)
- "У пятиугольной призмы найди число рёбер, граней и вершин. Проверь по формуле Эйлера. Как изменятся числа для шестиугольной призмы?" (подсчёт + проверка формулой + обобщение)`,

    medium: `Уровень: СРЕДНИЙ (10 класс)
Требования:
- Перпендикулярность прямой и плоскости + нахождение углов/расстояний через теорему Пифагора (8кл)
- Теорема о трёх перпендикулярах + вычисление площадей граней (8кл)
- Площадь поверхности призмы/пирамиды, комбинирование с тригонометрией (9кл)
- Часть заданий должна использовать планиметрию 7-9кл в пространственных фигурах

Примеры заданий:
- "В правильной 4-угольной пирамиде сторона основания 6, апофема 5. Найди высоту пирамиды и площадь полной поверхности" (Пифагор 8кл + площади 8кл)
- "В кубе с ребром 1 найди расстояние от вершины до диагонали противоположной грани" (перпендикулярность + теорема о трёх перпендикулярах + Пифагор)
- "Боковое ребро правильной треугольной призмы 10, сторона основания 6. Найди площадь диагонального сечения" (планиметрия основания 7-8кл + Пифагор)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (10 класс)
Требования:
- Угол между плоскостями + тригонометрия (9кл) + теорема Пифагора (8кл)
- Сечения многогранников + вычисление площади сечения через подобие (8кл) и площади (8кл)
- Комбинированные задачи, синтезирующие стереометрию с ВСЕЙ планиметрией 7-9кл
- Задания ОБЯЗАНЫ использовать: теорему о трёх перпендикулярах + площади (8кл) + тригонометрию (9кл) + подобие (8кл)

Примеры заданий:
- "В правильной треугольной пирамиде сторона основания 6, боковое ребро 5. Найди угол между боковой гранью и основанием, высоту и объём" (трёх перпендикуляров + тригонометрия 9кл + площадь равностороннего 7кл)
- "Построй сечение куба через середины трёх рёбер из одной вершины. Определи форму сечения и найди его площадь" (сечение + Пифагор + площадь 8кл)
- "В правильной 4-угольной пирамиде высота 3, сторона основания 8. Найди расстояние от центра основания до бокового ребра" (Пифагор + площадь треугольника 8кл + формула расстояния)`,
  },

  11: {
    easy: `Уровень: БАЗОВЫЙ (11 класс, уровень ЕГЭ часть 1 базовый)
Требования:
- Объёмы: вычисление + объяснение формулы (почему V = Sh для призмы, V = ⅓Sh для пирамиды), сравнение объёмов разных тел
- Тела вращения: объём и площадь поверхности + объяснение связи формул (через π, r, h), анализ как меняются при изменении параметров
- Координаты в пространстве: расстояние между точками + связь с теоремой Пифагора (8кл), определение вида фигуры по координатам вершин
- Задания требуют понимания формул и связей, а не только подстановки чисел

Примеры заданий:
- "Найди объём куба с ребром 4 и объём пирамиды с таким же основанием и высотой. Во сколько раз объём пирамиды меньше? Почему в формуле пирамиды коэффициент ⅓?" (два объёма + сравнение + анализ формулы)
- "Найди объём и полную площадь поверхности цилиндра (r = 3, h = 5). Как изменится объём, если радиус удвоить? А если удвоить высоту? Что влияет сильнее?" (вычисление + анализ зависимости)
- "Найди расстояние между A(1, 2, 3) и B(4, 6, 3). Объясни, почему формула расстояния — это обобщение теоремы Пифагора на 3D. Найди середину отрезка AB" (расстояние + связь с Пифагором 8кл + середина)`,

    medium: `Уровень: СРЕДНИЙ (11 класс)
Требования:
- Комбинации тел (вписанные, описанные) + вычисление через Пифагора (8кл) и тригонометрию (9кл)
- Уравнение плоскости + расстояние от точки до плоскости + координаты вершин многогранников (10кл)
- Объёмы + площади поверхности в одной задаче
- Часть заданий должна комбинировать: объём тела → площадь поверхности → подобие (8кл)

Примеры заданий:
- "В куб с ребром a вписан шар. Найди отношение их объёмов и отношение площадей поверхностей" (шар + куб + площади)
- "В правильной 4-угольной пирамиде сторона основания 6, высота 4. Найди объём и расстояние от центра основания до бокового ребра" (объём + Пифагор + площадь 8кл)
- "Конус с R=3, h=4 вписан в цилиндр. Найди отношение их объёмов и полных поверхностей" (два тела + сравнение)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (11 класс)
Требования:
- Задачи ЕГЭ профильного уровня (№ 13), синтезирующие стереометрию 10-11кл + всю планиметрию 7-9кл
- Сечения тел вращения + вычисление площадей сечений через подобие (8кл) и тригонометрию (9кл)
- Задачи на оптимизацию (связь с алгеброй: производная 11кл или неравенство)
- Задания ОБЯЗАНЫ синтезировать: объёмы/площади + Пифагор (8кл) + подобие (8кл) + тригонометрия (9кл) + теорема о трёх перпендикулярах (10кл)

Примеры заданий:
- "В конус с R=6, h=8 вписан шар. Найди его радиус, используя подобие осевого сечения" (конус + шар + подобие 8кл + Пифагор 8кл)
- "В шар R вписан конус наибольшего объёма. Вырази объём через R и найди отношение V(конус)/V(шар)" (оптимизация + объёмы + производная из алгебры 11кл)
- "Через две образующие конуса, угол между которыми 60°, проведено сечение. R=5, h=12. Найди площадь сечения" (сечение + тригонометрия 9кл + Пифагор 8кл + площадь треугольника)`,
  },
}

// =============================================================================
// Russian prompts (1-11 класс, grouped by ranges)
// =============================================================================

function getRussianPrompt(grade: number, level: DifficultyLevel): string {
  if (grade <= 2) {
    const prompts: Record<DifficultyLevel, string> = {
      easy: `Уровень: БАЗОВЫЙ (1-2 класс)
Требования:
- Деление на слоги
- Ударение
- Заглавная буква в именах

Примеры заданий:
- "Раздели слово 'молоко' на слоги"
- "Поставь ударение в слове 'портфель'"
- "Какие слова пишутся с заглавной буквы: река, Волга, город, Москва?"`,

      medium: `Уровень: СРЕДНИЙ (1-2 класс)
Требования:
- Правописание ЖИ-ШИ, ЧА-ЩА, ЧУ-ЩУ
- Мягкий знак для обозначения мягкости
- Перенос слов
- Часть заданий должна комбинировать: правописание + деление на слоги, или мягкий знак + перенос слов

Примеры заданий:
- "Вставь пропущенные буквы и раздели слова на слоги: ж_знь, ч_до, ш_рина" (правописание + слоги)
- "Где нужен мягкий знак? Раздели эти слова для переноса: ден_, кон_ки, мал_чик" (мягкий знак + перенос)
- "Раздели слова для переноса: яблоко, класс, объём"`,

      hard: `Уровень: ПОВЫШЕННЫЙ (1-2 класс)
Требования:
- Слова с непроверяемыми написаниями + правописание ЖИ-ШИ, ЧА-ЩА, ЧУ-ЩУ в одном тексте
- Составление предложений из слов с учётом заглавной буквы и орфографии
- Работа с деформированным текстом, где ученик применяет ВСЕ изученные правила
- Задания ДОЛЖНЫ комбинировать: орфографию + слоги + ударение + перенос + заглавная буква

Примеры заданий:
- "Найди и исправь ВСЕ ошибки: 'маша пошла в лес. Она набрала много гребов и жылудей.'" (заглавная буква + ЖИ-ШИ + безударная)
- "Составь предложение из слов, вставляя пропущенные буквы: на, ж_вёт, крыш_, кошка" (порядок слов + правописание)
- "Вставь буквы, поставь ударение и раздели для переноса: м_локо, м_шина, к_рзина" (безударная + ударение + перенос)`,
    }
    return prompts[level]
  }

  if (grade <= 4) {
    const prompts: Record<DifficultyLevel, string> = {
      easy: `Уровень: БАЗОВЫЙ (3-4 класс)
Требования:
- Однокоренные слова
- Части речи (определение)
- Главные члены предложения

Примеры заданий:
- "Подбери однокоренные слова к слову 'вода'"
- "Определи часть речи: красивый, бежать, дом"
- "Найди подлежащее и сказуемое: 'Солнце светит ярко'"`,

      medium: `Уровень: СРЕДНИЙ (3-4 класс)
Требования:
- Безударные гласные в корне (проверяемые), комбинирование с подбором однокоренных слов
- Парные согласные + безударные гласные в одном слове
- Состав слова (приставка, корень, суффикс, окончание) + определение части речи
- Часть заданий должна использовать навыки 1-2кл (ЖИ-ШИ, мягкий знак) в более сложных словах

Примеры заданий:
- "Подбери проверочное слово, вставь букву и разбери по составу: в_сёлый, п_бежал" (безударная + состав слова + часть речи)
- "Вставь все пропущенные буквы: сне_ки на з_мней д_рожке" (парные согласные + безударные + в контексте предложения)
- "Выдели корень и подбери 3 однокоренных слова. Определи часть речи каждого: лес" (однокоренные + части речи)`,

      hard: `Уровень: ПОВЫШЕННЫЙ (3-4 класс)
Требования:
- Непроизносимые согласные + безударные гласные + парные согласные в одном тексте
- Разделительные Ъ и Ь + состав слова + части речи
- Сложные случаи, комбинирующие ВСЕ орфограммы 1-4 классов
- Задания ДОЛЖНЫ синтезировать: несколько орфограмм + разбор слова + определение члена предложения

Примеры заданий:
- "Вставь ВСЕ пропущенные буквы, объясни каждую: Со_нце осв_тило праз_ничный гор_д" (непроизносимая + безударная + непроизносимая + парная — 4 орфограммы в 1 предложении)
- "Разбери по составу, определи часть речи и вставь букву: об_яснение, под_ём, с_едобный" (Ъ/Ь + состав + часть речи)
- "Найди главные члены предложения, подбери проверочные слова ко всем орфограммам: 'На лес_ной п_лянке р_сли чудес_ные цв_ты'" (синтаксис + 5 орфограмм)`,
    }
    return prompts[level]
  }

  if (grade <= 6) {
    const prompts: Record<DifficultyLevel, string> = {
      easy: `Уровень: БАЗОВЫЙ (5-6 класс)
Требования:
- Склонение существительных: определение С ОБЪЯСНЕНИЕМ признака (род, окончание), сравнение слов разных склонений
- Спряжение глаголов (I и II): определение с обоснованием (по инфинитиву или по личному окончанию), классификация группы глаголов
- Простое предложение: определение вида с опорой на интонацию и цель высказывания, сравнение похожих предложений разных видов
- Каждое задание требует НЕ просто определения, а классификации и объяснения: "определи И объясни почему"

Примеры заданий:
- "Распредели слова по склонениям и объясни, по какому признаку ты определил каждое: земля, конь, ночь, дядя, поле, степь" (классификация + объяснение принципа)
- "Определи спряжение глаголов и объясни, как ты это сделал: читать, строить, писать, смотреть. Какие из них исключения?" (определение + обоснование + выявление исключений)
- "Сравни предложения: 'Который час?', 'Скажи, который час', 'Уже поздно!'. Определи вид каждого и объясни, чем они различаются" (сравнение + классификация)`,

      medium: `Уровень: СРЕДНИЙ (5-6 класс)
Требования:
- Правописание окончаний существительных/прилагательных + определение склонения/падежа
- -ТСЯ/-ТЬСЯ + определение спряжения + лицо/число глагола
- Однородные члены + определение частей речи каждого члена
- Часть заданий должна сочетать: орфографию окончаний + синтаксический разбор + знания из 3-4кл (состав слова)

Примеры заданий:
- "Вставь окончание, определи падеж и склонение: на берегу рек_, в син_м неб_, к далёк_й звезд_" (окончание + падеж + склонение)
- "Вставь -ТСЯ или -ТЬСЯ, определи спряжение: Он (учит_ся) хорошо. Надо (учит_ся) лучше. Звёзды (отражают_ся) в воде" (орфография + спряжение + морфология)
- "Расставь знаки, подчеркни однородные члены и определи их часть речи: 'Ветер гнал ломал и кружил жёлтые листья'" (пунктуация + синтаксис + морфология)`,

      hard: `Уровень: ПОВЫШЕННЫЙ (5-6 класс)
Требования:
- Правописание приставок ПРЕ-/ПРИ- + безударные гласные в корне (3-4кл) + окончания существительных в одном тексте
- Н и НН в прилагательных + определение разряда прилагательного + состав слова (3-4кл)
- Сложные случаи пунктуации, комбинирующие: однородные + обращение + сложное предложение
- Задания ОБЯЗАНЫ синтезировать: орфографию 1-6кл + морфологию + синтаксис в одном задании

Примеры заданий:
- "Вставь ВСЕ пропущенные буквы: 'Пр_красная стекл_ая ваза ст_яла на деревя_ом стол_ у пр_открытого окна'" (ПРЕ/ПРИ + НН + безударная + НН + падежное окончание + ПРЕ/ПРИ — 6 орфограмм)
- "Объясни различие значений, составь предложения: 'преступить закон' и 'приступить к делу', 'претворить мечту' и 'притворить дверь'" (ПРЕ/ПРИ + значение + составление предложений)
- "Расставь все знаки, определи члены предложения: 'Друзья мои прекрасен наш союз он как душа неразделим и вечен'" (обращение + однородные + сложное предложение + знания всех правил)`,
    }
    return prompts[level]
  }

  if (grade <= 8) {
    const prompts: Record<DifficultyLevel, string> = {
      easy: `Уровень: БАЗОВЫЙ (7-8 класс)
Требования:
- Причастие и деепричастие: образование + объяснение морфологических признаков, сравнение с другими частями речи (прилагательное, глагол)
- Наречие: определение с обоснованием (вопрос, синтаксическая роль), различение наречия и краткого прилагательного в контексте
- Двусоставные и односоставные предложения: определение типа + выделение грамматической основы + объяснение, почему предложение односоставное
- Каждое задание требует АНАЛИЗА: "определи И объясни", "найди И докажи", "сравни И обоснуй"

Примеры заданий:
- "Образуй от глагола 'читать' причастие и деепричастие. Чем они различаются по значению? Какие признаки глагола и прилагательного сохранило причастие?" (образование + анализ морфологических признаков)
- "Определи часть речи слова 'тепло' в предложениях: 'На улице тепло', 'Тепло костра согревало нас', 'Она тепло улыбнулась'. Объясни, как ты определил" (различение омонимичных форм + обоснование)
- "Выдели грамматическую основу, определи тип предложения и объясни: 'Вечереет', 'На улице вечереет', 'Скоро будет вечереть'. Почему все три — односоставные?" (грамматическая основа + анализ + объяснение)`,

      medium: `Уровень: СРЕДНИЙ (7-8 класс)
Требования:
- Причастный/деепричастный обороты + Н/НН в причастиях + правописание суффиксов
- НЕ с разными частями речи, комбинирование с орфографией из 5-6кл (НЕ + приставки + окончания)
- Виды односоставных предложений + пунктуация при обособленных членах
- Часть заданий должна комбинировать: пунктуация оборотов + орфография причастий + НЕ

Примеры заданий:
- "Расставь знаки и вставь Н или НН: 'Книга лежавшая на краше_ом столе была не прочита_а'" (оборот + НН + НЕ с причастием)
- "Раскрой скобки, объясни правило для каждого: (не)большой дом, (не)сдела_ая работа, (не)смотря на (не)погоду" (НЕ + НН + разные части речи)
- "Определи тип односоставного, подчеркни грамматическую основу: 'Пишу письмо', 'Темнеет', 'Тишина', 'Нас пригласили'" (типы + разбор)`,

      hard: `Уровень: ПОВЫШЕННЫЙ (7-8 класс)
Требования:
- Сложные случаи с причастиями/деепричастиями + НЕ + Н/НН + правописание суффиксов из 5-6кл
- Вводные слова + обращения + обособленные члены + однородные — всё в одном предложении
- Различение односоставных и неполных двусоставных + грамматические ошибки
- Задания ОБЯЗАНЫ синтезировать: пунктуацию 5-8кл + орфографию 1-6кл + морфологию + синтаксис

Примеры заданий:
- "Исправь грамматическую ошибку и расставь ВСЕ знаки: 'Подъезжая к станции и увидев пр_красный пейзаж у меня слетела шляпа'" (деепричастный оборот + грамматика + ПРЕ/ПРИ из 5-6кл + пунктуация)
- "Расставь знаки, определи тип каждого предложения: 'Конечно друзья мои жизнь прожить не поле перейти и казнить нельзя помиловать'" (вводное + обращение + БСП + фразеологизм)
- "Вставь буквы, расставь знаки, определи типы предложений: 'Мне н_когда не забыть этот тихий (не)большой городок освещё_ый заходящ_м солнц_м'" (орфография + причастный оборот + определение типа)`,
    }
    return prompts[level]
  }

  // 9 класс
  if (grade === 9) {
    const prompts: Record<DifficultyLevel, string> = {
      easy: `Уровень: БАЗОВЫЙ (9 класс, уровень ОГЭ часть 1)
Требования:
- Сложные предложения: определение типа связи (ССП, СПП, БСП) в контексте нескольких предложений, с обоснованием выбора
- Виды придаточных: работа с текстовыми фрагментами (2-3 предложения), где нужно найти придаточное И объяснить его роль
- Пунктуация в сложных предложениях: расстановка знаков с учётом оборотов (7-8кл) внутри частей
- Задания должны включать контекст и обоснование, а НЕ просто "определи тип по одному предложению"

Примеры заданий:
- "Прочитай фрагмент. Найди все сложные предложения, определи тип связи в каждом и объясни, какой знак стоит на границе частей: 'Солнце село за горизонт, и небо окрасилось в багровый цвет. Мы молчали, потому что слова были не нужны.'" (анализ контекста + два типа связи + пунктуация)
- "Из предложения выпиши грамматические основы, определи вид каждого придаточного и перестрой в БСП: 'Когда начался дождь, мы укрылись в беседке, которая стояла на берегу озера'" (грамматическая основа + виды придаточных + трансформация)
- "Расставь знаки в предложении с причастным оборотом внутри придаточного: 'Я вспомнил дом в котором жила тётушка готовившая удивительные пироги'" (СПП + оборот из 7кл + пунктуация)`,

      medium: `Уровень: СРЕДНИЙ (9 класс, уровень ОГЭ части 1-2)
Требования:
- СПП с несколькими придаточными: составление схемы, определение типов подчинения (последовательное, параллельное, однородное)
- Пунктуация на стыке союзов + обороты (7-8кл) + вводные слова внутри сложных конструкций
- Синтаксический анализ текста: определение типа каждого предложения + средства связи между ними
- Комбинирование: пунктуация сложного предложения + обособление из 7-8кл + орфография из 5-6кл (Н/НН, НЕ, ПРЕ/ПРИ)

Примеры заданий:
- "Расставь ВСЕ знаки, вставь буквы, составь схему: 'Когда я вошёл в комнату где горел написа_ый масл_ыми красками пр_красный пейзаж все замолчали'" (СПП с последовательным подчинением + причастный оборот + Н/НН + ПРЕ/ПРИ)
- "Определи тип подчинения придаточных, перестрой предложение так, чтобы подчинение стало другим типом: 'Он сказал что если погода будет хорошей то мы поедем на озеро которое расположе_о (не)далеко'" (3 придаточных + трансформация + орфография)
- "В тексте из 3 предложений найди все средства связи (союзы, указательные слова, лексические повторы), определи типы предложений и объясни пунктуацию" (комплексный анализ)`,

      hard: `Уровень: ПОВЫШЕННЫЙ (9 класс, уровень сложных заданий ОГЭ части 2)
Требования:
- Задания формата ОГЭ (задания 2-5, 8-9): комплексный анализ текста с синтезом ВСЕЙ программы 5-9 классов
- Сложные случаи пунктуации: стык союзов + обороты + вводные + однородные в одном тексте
- Анализ текста: определение типа речи по фрагменту + объяснение роли языковых средств + синтаксический разбор
- Задания ОБЯЗАНЫ синтезировать: сложный синтаксис 9кл + обороты 7-8кл + орфографию 5-6кл + морфологию 5-6кл

Примеры заданий:
- "Найди ВСЕ ошибки (грамматические + пунктуационные + орфографические) и исправь: 'Подъезжая к (не)знакомому городу освящё_ому закатным солнцем и нас охватило чувство что мы (не)зря проделали этот путь'" (грамматика деепричастия + НЕ + НН + пунктуация СПП + стык союзов)
- "Прочитай текст. Определи тип речи каждого абзаца, объясни, как автор комбинирует повествование и рассуждение. Найди все сложные предложения, составь схемы, объясни пунктуацию" (типы речи + синтаксис + пунктуация — полный анализ)
- "Перестрой текст из 3 БСП в 3 СПП, сохранив смысл. Объясни, как изменились смысловые отношения между частями. Расставь знаки, вставь все пропущенные буквы" (трансформация + анализ + орфография)`,
    }
    return prompts[level]
  }

  // 10 класс
  if (grade === 10) {
    const prompts: Record<DifficultyLevel, string> = {
      easy: `Уровень: БАЗОВЫЙ (10 класс, уровень ЕГЭ часть 1 базовый)
Требования:
- Орфография: обобщение правил правописания в контексте (НЕ изолированно, а в предложениях/текстах), работа с паронимами
- Лексические нормы: выявление ошибок в употреблении слов, подбор синонимов с учётом стиля
- Морфологические нормы: образование форм слова, выявление грамматических ошибок в контексте
- Задания требуют анализа в контексте, а НЕ изолированного определения — ученик работает с предложениями и текстовыми фрагментами

Примеры заданий:
- "В каком предложении допущена ошибка в употреблении паронимов? Исправь и объясни различие значений: 1) Он надел тёплое пальто. 2) Дипломатический скандал обсуждался в прессе. 3) Командир отдал воинственный приказ" (паронимы + контекст + объяснение)
- "Найди предложение с грамматической ошибкой, исправь и определи тип ошибки: 1) Благодаря помощи друзей... 2) Согласно расписания... 3) По приезде в город..." (морфологические нормы + анализ)
- "Вставь пропущенные буквы, объясни выбор каждой орфограммы в контексте предложения: 'Пр_зидент пр_дприятия пр_красно справлялся с (не)лёгкими обяза_остями'" (ПРЕ/ПРИ + НЕ + НН — обобщение в контексте)`,

      medium: `Уровень: СРЕДНИЙ (10 класс, уровень ЕГЭ часть 1 профильный)
Требования:
- Комплексный анализ орфографии: все типы орфограмм (5-9кл) в одном тексте с объяснением каждого выбора
- Лексика и стилистика: определение функционального стиля + выявление стилистических ошибок + средства выразительности
- Синтаксические нормы: ошибки в построении предложений (нарушение связи подлежащего и сказуемого, ошибки в управлении, деепричастные обороты)
- Комбинирование: орфография + пунктуация + грамматические нормы + стилистика в одном задании

Примеры заданий:
- "Вставь ВСЕ буквы, расставь знаки, определи стиль текста и найди 2 средства выразительности: 'В (не)обозримой дали расст_лалось поле засея_ое пшеницей которая (по)осе_ему золотилась на солнце пр_дававш_м пейзажу торжестве_ость'" (все орфограммы + пунктуация + стилистика)
- "Найди и исправь ВСЕ грамматические ошибки (5 предложений). Определи тип каждой ошибки. Объясни правило" (синтаксические нормы + морфологические нормы + системный анализ)
- "Сравни два текста на одну тему в разных стилях. Укажи: стилевые черты, средства выразительности, синтаксические особенности. Вставь пропущенные буквы" (стилистика + орфография + синтаксис)`,

      hard: `Уровень: ПОВЫШЕННЫЙ (10 класс, уровень ЕГЭ часть 2)
Требования:
- Задания формата ЕГЭ (задания 8, 21, 25-26): комплексный анализ с синтезом ВСЕЙ программы 5-10кл
- Сложные случаи орфографии и пунктуации, где нужно учитывать контекст, стиль и значение (НЕ формальное применение правил)
- Анализ текста: проблематика + позиция автора + средства выразительности + все типы орфограмм и пунктограмм
- Задания ОБЯЗАНЫ синтезировать: орфографию + пунктуацию + лексику + стилистику + синтаксические нормы

Примеры заданий:
- "Прочитай текст. Определи проблему, сформулируй позицию автора. Найди: 3 средства выразительности (с примерами), все орфограммы, объясни пунктуацию в 2 самых сложных предложениях" (полный анализ текста)
- "Исправь ВСЕ ошибки (орфо + пункт + грамматика + стилистика) в тексте из 5-6 предложений. Определи стиль текста и объясни, почему некоторые конструкции нарушают стилевое единство" (комплексное редактирование)
- "Перепиши фрагмент публицистического текста в научном стиле, сохранив содержание. Объясни все замены, вставь пропущенные буквы, расставь знаки в обоих вариантах" (стилистическая трансформация + орфография + пунктуация)`,
    }
    return prompts[level]
  }

  // 11 класс
  const prompts: Record<DifficultyLevel, string> = {
    easy: `Уровень: БАЗОВЫЙ (11 класс, уровень ЕГЭ часть 1 базовый)
Требования:
- Комплексное повторение орфографии в контексте: работа с текстом, где нужно применить правила из РАЗНЫХ классов (5-10)
- Пунктуация: все типы знаков в сложных конструкциях (ССП + СПП + обороты + вводные) — но с опорой на правило
- Языковые средства выразительности: определение в контексте с объяснением функции
- Задания работают с ТЕКСТОМ (не с изолированными предложениями) и требуют обоснования выбора

Примеры заданий:
- "Вставь буквы и расставь знаки в тексте из 3 предложений. Для каждой орфограммы укажи правило, для каждого знака — обоснование: 'В (не)большом зале ув_ша_ом стари_ыми к_врами царила тиш_на которую нарушал только скрип п_ловиц'" (орфография 5-8кл + пунктуация 7-9кл + обоснование)
- "Определи средства выразительности в каждом предложении и объясни их роль в тексте: метафора, эпитет, сравнение, олицетворение — не просто назови, а покажи, как они работают на замысел автора" (анализ + функция средства)
- "Найди предложение без пунктуационной ошибки. В остальных расставь знаки и объясни каждый, указывая тип конструкции (обособление, ССП, СПП, вводное)" (пунктуация + классификация + обоснование)`,

    medium: `Уровень: СРЕДНИЙ (11 класс, уровень ЕГЭ часть 1 профильный)
Требования:
- Задания формата ЕГЭ (задания 9-15, 16-21): орфография и пунктуация в сложных контекстах с ловушками
- Лексический анализ текста: паронимы + средства выразительности + стилистика — в комплексе
- Синтаксический анализ: все типы связи в предложении + грамматические нормы + пунктуация — в одном тексте
- Комбинирование: ВСЕ разделы языка (фонетика, лексика, морфемика, морфология, синтаксис) должны быть задействованы

Примеры заданий:
- "Выполни задания по тексту: 1) Вставь все буквы (объясни), 2) Расставь все знаки (объясни), 3) Найди 3 средства выразительности, 4) Определи стиль и тип речи, 5) Найди грамматическую ошибку" (комплексный ЕГЭ-анализ)
- "В тексте из 4 предложений найди все случаи: а) слитного/раздельного написания НЕ (3 типа), б) Н/НН (2 типа), в) ПРЕ/ПРИ (2 примера). Объясни каждый случай, указав морфологическую принадлежность слова" (орфография + морфология)
- "Составь схемы всех сложных предложений в тексте. Определи типы связи, виды придаточных. Найди случаи стыка союзов и объясни пунктуацию" (синтаксис + пунктуация + классификация)`,

    hard: `Уровень: ПОВЫШЕННЫЙ (11 класс, уровень ЕГЭ часть 2 профильный)
Требования:
- Задания формата ЕГЭ (задания 22-27): полный филологический анализ текста
- Сложнейшие случаи пунктуации: стык союзов + обороты внутри придаточных + вводные конструкции + бессоюзие — всё в одном тексте
- Анализ текста: проблема + позиция автора + аргументация + все средства выразительности + связь формы и содержания
- Задания ОБЯЗАНЫ синтезировать ВСЮ программу 1-11кл: орфографию + пунктуацию + лексику + морфологию + синтаксис + стилистику + речеведение

Примеры заданий:
- "Прочитай текст. Выполни полный анализ: 1) Определи проблему и позицию автора, 2) Найди ВСЕ средства выразительности (не менее 5 типов), объясни их функцию, 3) Вставь все буквы и расставь знаки, 4) Составь схемы 2 самых сложных предложений" (ЕГЭ-27 + языковой анализ)
- "Исправь ВСЕ ошибки в сочинении ученика (орфо + пункт + грамматика + речевые + логические). Классифицируй каждую ошибку. Предложи улучшенный вариант проблемных фрагментов" (комплексное редактирование + классификация)
- "Сравни два текста на одну тему: художественный и публицистический. Проанализируй: а) стилевые черты каждого, б) средства выразительности и их функции, в) синтаксические особенности, г) авторскую позицию и способы её выражения" (сопоставительный анализ — высший уровень)`,
  }
  return prompts[level]
}

// =============================================================================
// Generic fallback
// =============================================================================

const GENERIC_PROMPTS: Record<DifficultyLevel, string> = {
  easy: `Уровень: БАЗОВЫЙ
Требования:
- Прямое применение правил и формул без усложнений
- Простые числа и примеры
- Решение в 1-2 шага
- Однозначные формулировки без подвохов
- Задания от простых к чуть более сложным (но всё в рамках базового)`,

  medium: `Уровень: СРЕДНИЙ
Требования:
- Стандартные ситуации из учебника, но НЕ тривиальные
- Решение в 2-3 шага
- Требуется понимание темы и связь с ранее изученным материалом
- Часть заданий должна комбинировать текущую тему с темами, пройденными ранее
- Могут потребоваться промежуточные вычисления и преобразования`,

  hard: `Уровень: ПОВЫШЕННЫЙ
Требования:
- Нестандартные формулировки и контексты
- Решение в 3-5 шагов
- ОБЯЗАТЕЛЬНО комбинирование текущей темы с ранее пройденными темами и навыками
- Задания олимпиадного типа, требующие синтеза нескольких разделов
- Самые сложные задания могут включать элементы тем, идущих после текущей по программе`,
}

// =============================================================================
// Main function
// =============================================================================

export function getDifficultyPrompt(
  level: DifficultyLevel,
  subject: string,
  grade: number
): string {
  switch (subject) {
    case 'math': {
      const gradePrompts = MATH_PROMPTS[grade]
      if (gradePrompts) return gradePrompts[level]
      break
    }
    case 'algebra': {
      const gradePrompts = ALGEBRA_PROMPTS[grade]
      if (gradePrompts) return gradePrompts[level]
      break
    }
    case 'geometry': {
      const gradePrompts = GEOMETRY_PROMPTS[grade]
      if (gradePrompts) return gradePrompts[level]
      break
    }
    case 'russian':
      return getRussianPrompt(grade, level)
  }

  return GENERIC_PROMPTS[level]
}

// =============================================================================
// Backward-compatible exports
// =============================================================================

export function getDifficulty(id: DifficultyLevel): DifficultyConfig {
  const config = difficultyLevels[id]
  if (!config) {
    throw new Error(`Unknown difficulty level: ${id}`)
  }
  return config
}

export function getAllDifficulties(): DifficultyConfig[] {
  return Object.values(difficultyLevels)
}

export function isValidDifficulty(id: string): id is DifficultyLevel {
  return id in difficultyLevels
}

export function getDefaultDifficulty(): DifficultyLevel {
  return 'medium'
}
