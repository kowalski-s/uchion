import type { GradeTierConfig } from '../../types.js'

export const mathGradeTiers: GradeTierConfig[] = [
  // Tier 1: 1-2 класс — базовая арифметика
  {
    grades: [1, 2],
    cognitiveContract: `ЗАПРЕЩЁННЫЕ ПАТТЕРНЫ (слишком примитивные):
\u274C "Сколько будет 2 + 3?" без контекста \u2192 ЗАМЕНИ на задачу с жизненной ситуацией или сравнением
\u274C Задания только на один изолированный навык \u2192 ЗАМЕНИ на задания, где нужен хотя бы один дополнительный шаг (проверка, сравнение, выбор действия)
\u274C Механическое вычисление без осмысления \u2192 ЗАМЕНИ на задания со смысловым контекстом

ОБЯЗАТЕЛЬНЫЕ ЭЛЕМЕНТЫ В КАЖДОМ ЗАДАНИИ (минимум один):
\u2713 КОНТЕКСТ: задача из реальной жизни (магазин, школа, игры, семья)
\u2713 СРАВНЕНИЕ: "больше или меньше", "сравни результаты", "какое число больше и почему"
\u2713 ПРОВЕРКА: "проверь вычитанием", "подставь и проверь"`,

    exampleTask: `Тема "Сложение и вычитание в пределах 20", 1 класс, open_question:
"На ветке сидели 8 птиц. 3 улетели, а потом прилетели ещё 5. Сколько птиц стало на ветке? Проверь: сравни, стало больше или меньше, чем было сначала."
(сложение + вычитание + сравнение)`,
  },

  // Tier 2: 3-4 класс — сравнение и объяснение
  {
    grades: [3, 4],
    cognitiveContract: `ЗАПРЕЩЁННЫЕ ПАТТЕРНЫ (уровень 1-2 класса — слишком просто):
\u274C "Вычисли: 7 \u00d7 8" без контекста \u2192 ЗАМЕНИ на задачу, где нужно выбрать действие и объяснить выбор
\u274C Задания в одно действие без объяснения \u2192 ЗАМЕНИ на задания в 2-3 действия с объяснением метода
\u274C "Реши пример" без связи с реальностью \u2192 ЗАМЕНИ на задачу с практическим контекстом (покупки, измерения, время)
\u274C Изолированная арифметика без рассуждения \u2192 ЗАМЕНИ на задания со сравнением способов или проверкой результата

ОБЯЗАТЕЛЬНЫЕ ЭЛЕМЕНТЫ В КАЖДОМ ЗАДАНИИ (минимум один):
\u2713 МНОГОШАГОВОСТЬ: задача требует 2-3 действия
\u2713 ОБЪЯСНЕНИЕ МЕТОДА: "объясни, как решал", "какое действие выполнил первым и почему"
\u2713 СВЯЗЬ С ЖИЗНЬЮ: задачи на движение, покупки, время, площадь, периметр
\u2713 ПРОВЕРКА: "проверь результат другим способом", "оцени, реалистичен ли ответ"`,

    exampleTask: `Тема "Умножение и деление многозначных чисел", 4 класс, open_question:
"В школу привезли 252 учебника, их нужно разложить поровну в 6 классов. Сколько учебников получит каждый класс? Если в каждом классе 28 учеников, хватит ли учебников на всех? Объясни, как ты рассуждал."
(деление + сравнение + объяснение рассуждения)`,
  },

  // Tier 3: 5-6 класс — анализ и связи
  {
    grades: [5, 6],
    cognitiveContract: `ЗАПРЕЩЁННЫЕ ПАТТЕРНЫ (уровень 3-4 класса — слишком просто):
\u274C "Вычисли: 2/3 + 1/4" без контекста и обоснования \u2192 ЗАМЕНИ на "Вычисли и объясни способ приведения к общему знаменателю"
\u274C "Найди 25% от 200" изолированно \u2192 ЗАМЕНИ на задачу, где проценты связаны с дробями или пропорциями
\u274C Задания без связи с предыдущими классами \u2192 ЗАМЕНИ на задания, комбинирующие дроби/проценты с задачами на движение, площадь (4кл)
\u274C Однотипные вычисления без анализа \u2192 ЗАМЕНИ на задания со сравнением, проверкой или выбором оптимального способа

ОБЯЗАТЕЛЬНЫЕ ЭЛЕМЕНТЫ В КАЖДОМ ЗАДАНИИ (минимум один):
\u2713 АНАЛИЗ: "объясни почему", "в чём причина ошибки", "сравни способы решения"
\u2713 СВЯЗИ: комбинирование текущей темы с материалом прошлых классов (дроби + задачи на движение, проценты + площадь)
\u2713 ВЕРИФИКАЦИЯ: "проверь результат", "найди ошибку", "верно ли утверждение и почему"
\u2713 ОБОСНОВАНИЕ: "объясни выбор действия", "почему именно этот способ"`,

    exampleTask: `Тема "Проценты", 6 класс, open_question:
"Цена товара сначала выросла на 20%, а затем снизилась на 20%. Вернулась ли цена к начальной? Если начальная цена была 500 рублей, вычисли итоговую. Объясни, почему результат получился именно таким."
(проценты + вычисления + анализ + объяснение закономерности)`,
  },
]

export function getMathGradeTier(grade: number): GradeTierConfig | null {
  return mathGradeTiers.find(t => grade >= t.grades[0] && grade <= t.grades[1]) ?? null
}
